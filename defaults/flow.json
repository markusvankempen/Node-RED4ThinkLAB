[{"id":"98ac791d.6af398","type":"tab","label":"Your Sensor","disabled":false,"info":""},{"id":"2867dcd3.cb18c4","type":"tab","label":"ALL PWS on Map","disabled":false,"info":""},{"id":"4acf96d8.68a2f8","type":"tab","label":"Utils","disabled":false,"info":""},{"id":"b9b0f68.142db08","type":"wiotp","z":"","name":"o062sb"},{"id":"46b94481.65c85c","type":"wiotp","z":"","name":"n8ve7d-mARKUS SPACE"},{"id":"d6243246.e5fbd","type":"ibmiot","z":"","name":"IoTMvK","keepalive":"60","serverName":"","cleansession":true,"appId":"","shared":false},{"id":"f3d8c395.7a0d5","type":"ibmiot","z":"","name":"IoTBak","keepalive":"60","serverName":"","cleansession":true,"appId":"","shared":false},{"id":"c3ca51fe.2d4e6","type":"ui_group","z":"","name":"All PWS","tab":"b5674cbd.e0019","order":1,"disp":false,"width":"22","collapse":false},{"id":"b5674cbd.e0019","type":"ui_tab","z":"","name":"All PWS","icon":"dashboard","order":5,"disabled":false,"hidden":false},{"id":"6cdfc924.a49268","type":"ibmiot","z":"","name":"IoTMVK","keepalive":"60","serverName":"","cleansession":true,"appId":"","shared":false},{"id":"a4da6ce9.b3a48","type":"comment","z":"4acf96d8.68a2f8","name":"Get your Geo Location","info":"your url - node red instance /latlon\n\nhttps://thinklabxx.mybluemix.net/latlon\nor \n\n\nhttps://thinklab1239.mybluemix.net/latlon","x":140,"y":60,"wires":[]},{"id":"c06a1d85.58fd1","type":"http in","z":"4acf96d8.68a2f8","name":"","url":"/latlon","method":"post","upload":false,"swaggerDoc":"","x":110,"y":140,"wires":[["3ab73525.d6ceba"]]},{"id":"3ab73525.d6ceba","type":"template","z":"4acf96d8.68a2f8","name":"page","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"<!DOCTYPE html>\n<html>\n<body>\n\n\n<h1>ThinkLAB-1239 - You IP Geo Location  </h1>\n\n\n  <p id=\"demo\"> Pleas wait a little ...  </p>\n  \n\n</form>\n\n<script>//http://ipinfo.io/?callback=callback&token=e41dd43255baff\nvar script = document.createElement('script');\nscript.src = '//ipinfo.io/?callback=ipinfo&token=e41dd43255baff';\ndocument.body.appendChild(script);\nvar ipinfos={}\nvar x = document.getElementById(\"demo\");\nfunction ipinfo(data) {\n    document.getElementById(\"info\").value = JSON.stringify(data); \n        var ipi = document.getElementById(\"ipinfo\");\n    ipi.innerHTML.value = JSON.stringify(data); \n    console.log(data)\n    ipinfos=data;\n}\nfunction getLocation() {\n  if (navigator.geolocation) {\n    navigator.geolocation.getCurrentPosition(showPosition);\n  } else { \n    x.innerHTML = \"Geolocation is not supported by this browser.\";\n  }\n}\n\n\n\ngetLocation() \n\n\n</script>\n</body>\n</html>\n","x":310,"y":140,"wires":[["fbb9f202.cd959"]]},{"id":"fbb9f202.cd959","type":"http response","z":"4acf96d8.68a2f8","name":"","x":470,"y":140,"wires":[]},{"id":"1fbaf088.138cef","type":"http request","z":"98ac791d.6af398","name":"Current Weather TWC","method":"GET","ret":"obj","paytoqs":false,"url":"","tls":"","persist":false,"proxy":"","authType":"","x":660,"y":540,"wires":[["c2679aab.ca8158","76d6b3b6.69986c"]]},{"id":"b4ee45dc.26cc68","type":"change","z":"98ac791d.6af398","name":"New key Set TWC API Key here","rules":[{"t":"set","p":"twcapikey","pt":"flow","to":"5424e9662cbf4bc3a4e9662cbf4bc3fe","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":490,"y":300,"wires":[["9150ef3d.ab492"]]},{"id":"bb20e021.2ce11","type":"inject","z":"98ac791d.6af398","name":"Init TWC API Key","topic":"","payload":"true","payloadType":"bool","repeat":"30","crontab":"","once":true,"onceDelay":"2","x":170,"y":300,"wires":[["b4ee45dc.26cc68"]]},{"id":"9150ef3d.ab492","type":"debug","z":"98ac791d.6af398","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":850,"y":300,"wires":[]},{"id":"12bf8a72.8c6156","type":"change","z":"98ac791d.6af398","name":"Set Location","rules":[{"t":"set","p":"lat","pt":"flow","to":"28","tot":"str"},{"t":"set","p":"lon","pt":"flow","to":"-42","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":430,"y":460,"wires":[["9b1db57d.977798"]]},{"id":"373b676a.714c38","type":"inject","z":"98ac791d.6af398","name":"Set Default Location (Lat/Lon)","topic":"","payload":"true","payloadType":"bool","repeat":"","crontab":"","once":false,"onceDelay":"10","x":180,"y":460,"wires":[["12bf8a72.8c6156"]]},{"id":"9b1db57d.977798","type":"function","z":"98ac791d.6af398","name":"","func":"msg.payload={}\nmsg.payload.lat=flow.get(\"lat\")\nmsg.payload.lon=flow.get(\"lon\")\nif(flow.get(\"labid\") == \"NoLabID\")\nnode.warn(\"no LABID set please adjust \")\nreturn msg;","outputs":1,"noerr":0,"x":680,"y":460,"wires":[["91513942.e0e918"]]},{"id":"76d6b3b6.69986c","type":"debug","z":"98ac791d.6af398","name":"TWC Api Call","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":870,"y":460,"wires":[]},{"id":"4a369750.b19858","type":"change","z":"98ac791d.6af398","name":"SET LAB ID","rules":[{"t":"set","p":"labid","pt":"flow","to":"NoLabID","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":430,"y":180,"wires":[["50b6e2f5.6cc5ec","2c3283a0.d594ec"]]},{"id":"60dedeb9.1ce96","type":"inject","z":"98ac791d.6af398","name":"LABID","topic":"","payload":"true","payloadType":"bool","repeat":"30","crontab":"","once":true,"onceDelay":"1","x":140,"y":180,"wires":[["4a369750.b19858"]]},{"id":"50b6e2f5.6cc5ec","type":"debug","z":"98ac791d.6af398","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":850,"y":180,"wires":[]},{"id":"91513942.e0e918","type":"function","z":"98ac791d.6af398","name":"setup url.api call","func":"//\"https://api.weather.com/v2/pws/history/hourly?stationId=ITORONTO308&format=json&units=m&date={}&apiKey=\"\n    \nmyurl= \"https://api.weather.com/v3/wx/observations/current?apiKey=\"+flow.get(\"twcapikey\")+\"&geocode=\"+flow.get(\"lat\")+\"%2C\"+flow.get(\"lon\")+\"&units=m&language=en-US&format=json\"\nmsg.url=myurl\nreturn msg;","outputs":1,"noerr":0,"x":400,"y":540,"wires":[["1fbaf088.138cef"]]},{"id":"6d632759.9bd548","type":"comment","z":"98ac791d.6af398","name":"API documentation","info":"https://weather.com/swagger-docs/call-for-code","x":650,"y":580,"wires":[]},{"id":"2c3283a0.d594ec","type":"function","z":"98ac791d.6af398","name":"labid","func":"msg.payload=flow.get(\"labid\")\nreturn msg;","outputs":1,"noerr":0,"x":590,"y":120,"wires":[["50b6e2f5.6cc5ec"]]},{"id":"ce523d1e.39204","type":"comment","z":"98ac791d.6af398","name":"Infos","info":"1. Get Your ID  via thinklab1239.mybluemix.net/claimids\n2. Set Your Location \n3. Get a Weather API key https://callforcode.weather.com/register/","x":130,"y":20,"wires":[]},{"id":"2d2f7d9f.7234c2","type":"debug","z":"98ac791d.6af398","name":"MyPWSIncoming","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","x":550,"y":640,"wires":[]},{"id":"ba8ed8b4.2d4428","type":"ibmiot in","z":"98ac791d.6af398","authentication":"boundService","apiKey":"f3d8c395.7a0d5","inputType":"evt","logicalInterface":"","ruleId":"","deviceId":"pws01","applicationId":"","deviceType":"pws","eventType":"+","commandType":"","format":"json","name":"allPWSIncoming","service":"registered","allDevices":true,"allApplications":"","allDeviceTypes":false,"allLogicalInterfaces":"","allEvents":true,"allCommands":"","allFormats":"","qos":0,"x":130,"y":640,"wires":[["ca824647.938588"]]},{"id":"c2679aab.ca8158","type":"function","z":"98ac791d.6af398","name":"Mapping","func":"msg.payloadold=msg.payload\nmsg.payload={}\nmsg.payload.temperature=msg.payloadold.temperature\nmsg.payload.observation=msg.payloadold.wxPhraseLong\nmsg.payload.humidity   =msg.payloadold.relativeHumidity\nmsg.payload.pressure   =msg.payloadold.pressureMeanSeaLevel\nmsg.payload.uvindex    =msg.payloadold.uvIndex\nmsg.payload.precip     =msg.payloadold.precip1Hour\nmsg.payload.icon       =msg.payloadold.iconCode\nmsg.payload.ts         =Date.now()\nmsg.payload.messtime   =msg.payloadold.validTimeLocal\nmsg.payload.day=msg.payloadold.dayOfWeek\nmsg.payload.lat=parseFloat(flow.get(\"lat\"))\nmsg.payload.lon=parseFloat(flow.get(\"lon\"))\nmsg.payload.source=\"TWC\"\nmsg.payload.pws=flow.get(\"labid\")\nmsg.deviceId=\"pws\"+msg.payload.pws\nreturn msg;\n/*\n{\n    \"cloudCeiling\": 5000,\n    \"cloudCoverPhrase\": \"Mostly Cloudy\",\n    \"dayOfWeek\": \"Friday\",\n    \"dayOrNight\": \"D\",\n    \"expirationTimeUtc\": 1586545455,\n    \"iconCode\": 28,\n    \"iconCodeExtend\": 2890,\n    \"obsQualifierCode\": null,\n    \"obsQualifierSeverity\": null,\n    \"precip1Hour\": 0,\n    \"precip6Hour\": 0,\n    \"precip24Hour\": 0,\n    \"pressureAltimeter\": 1005.08,\n    \"pressureChange\": 2.03,\n    \"pressureMeanSeaLevel\": 1005.2,\n    \"pressureTendencyCode\": 1,\n    \"pressureTendencyTrend\": \"Rising\",\n    \"relativeHumidity\": 42,\n    \"snow1Hour\": 0,\n    \"snow6Hour\": 0,\n    \"snow24Hour\": 0,\n    \"sunriseTimeLocal\": \"2020-04-10T06:43:19-0400\",\n    \"sunriseTimeUtc\": 1586515399,\n    \"sunsetTimeLocal\": \"2020-04-10T19:56:57-0400\",\n    \"sunsetTimeUtc\": 1586563017,\n    \"temperature\": 7,\n    \"temperatureChange24Hour\": -2,\n    \"temperatureDewPoint\": -5,\n    \"temperatureFeelsLike\": 2,\n    \"temperatureHeatIndex\": 7,\n    \"temperatureMax24Hour\": 8,\n    \"temperatureMaxSince7Am\": 7,\n    \"temperatureMin24Hour\": 1,\n    \"temperatureWindChill\": 2,\n    \"uvDescription\": \"Moderate\",\n    \"uvIndex\": 4,\n    \"validTimeLocal\": \"2020-04-10T14:54:15-0400\",\n    \"validTimeUtc\": 1586544855,\n    \"visibility\": 16.09,\n    \"windDirection\": 300,\n    \"windDirectionCardinal\": \"WNW\",\n    \"windGust\": 56,\n    \"windSpeed\": 37,\n    \"wxPhraseLong\": \"Mostly Cloudy/Wind\",\n    \"wxPhraseMedium\": \"Mostly Cloudy/Wind\",\n    \"wxPhraseShort\": \"M Cldy/Wind\"\n}\n*/","outputs":1,"noerr":0,"x":860,"y":540,"wires":[["6fc3da4f.670304","a3d7880.a339d78"]]},{"id":"8acf07e4.c22468","type":"inject","z":"98ac791d.6af398","name":"Payload TWC example","topic":"","payload":"{\"cloudCeiling\":5000,\"cloudCoverPhrase\":\"Mostly Cloudy\",\"dayOfWeek\":\"Friday\",\"dayOrNight\":\"D\",\"expirationTimeUtc\":1586545455,\"iconCode\":28,\"iconCodeExtend\":2890,\"obsQualifierCode\":null,\"obsQualifierSeverity\":null,\"precip1Hour\":0,\"precip6Hour\":0,\"precip24Hour\":0,\"pressureAltimeter\":1005.08,\"pressureChange\":2.03,\"pressureMeanSeaLevel\":1005.2,\"pressureTendencyCode\":1,\"pressureTendencyTrend\":\"Rising\",\"relativeHumidity\":42,\"snow1Hour\":0,\"snow6Hour\":0,\"snow24Hour\":0,\"sunriseTimeLocal\":\"2020-04-10T06:43:19-0400\",\"sunriseTimeUtc\":1586515399,\"sunsetTimeLocal\":\"2020-04-10T19:56:57-0400\",\"sunsetTimeUtc\":1586563017,\"temperature\":7,\"temperatureChange24Hour\":-2,\"temperatureDewPoint\":-5,\"temperatureFeelsLike\":2,\"temperatureHeatIndex\":7,\"temperatureMax24Hour\":8,\"temperatureMaxSince7Am\":7,\"temperatureMin24Hour\":1,\"temperatureWindChill\":2,\"uvDescription\":\"Moderate\",\"uvIndex\":4,\"validTimeLocal\":\"2020-04-10T14:54:15-0400\",\"validTimeUtc\":1586544855,\"visibility\":16.09,\"windDirection\":300,\"windDirectionCardinal\":\"WNW\",\"windGust\":56,\"windSpeed\":37,\"wxPhraseLong\":\"Mostly Cloudy/Wind\",\"wxPhraseMedium\":\"Mostly Cloudy/Wind\",\"wxPhraseShort\":\"M Cldy/Wind\"}","payloadType":"json","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":160,"y":380,"wires":[[]]},{"id":"6fc3da4f.670304","type":"debug","z":"98ac791d.6af398","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":1030,"y":540,"wires":[]},{"id":"5a28037e.ef308c","type":"comment","z":"98ac791d.6af398","name":" Get a Weather API key","info":"1. Get Your ID  via thinklab1239.mybluemix.net/claimids\n2. Set Your Location \n3. Get a Weather API key https://callforcode.weather.com/register/\n4. 5424e9662cbf4bc3a4e9662cbf4bc3fe","x":440,"y":260,"wires":[]},{"id":"a3d7880.a339d78","type":"ibmiot out","z":"98ac791d.6af398","authentication":"boundService","apiKey":"","outputType":"evt","deviceId":"issetinmapping","deviceType":"pws","eventCommandType":"weather","format":"json","data":"msg.payload","qos":0,"name":"MyPWS","service":"registered","x":860,"y":600,"wires":[]},{"id":"676fef74.cd41","type":"comment","z":"98ac791d.6af398","name":"1st Step - Set LABID","info":"1. Get Your ID  via thinklab1239.mybluemix.net/claimids\n2. Set Your Location \n3. Get a Weather API key https://callforcode.weather.com/register/","x":170,"y":140,"wires":[]},{"id":"ce9bb355.e4359","type":"comment","z":"98ac791d.6af398","name":"2st Step - Set TWC API Key","info":"1. Get Your ID  via thinklab1239.mybluemix.net/claimids\n2. Set Your Location \n3. Get a Weather API key https://callforcode.weather.com/register/","x":200,"y":260,"wires":[]},{"id":"80c5b452.e2b3b8","type":"comment","z":"98ac791d.6af398","name":"3rd Step - Set Your Lat/Lon location","info":"1. Get Your ID  via thinklab1239.mybluemix.net/claimids\n2. Set Your Location \n3. Get a Weather API key https://callforcode.weather.com/register/","x":220,"y":420,"wires":[]},{"id":"1d6d00a7.48d44f","type":"comment","z":"98ac791d.6af398","name":"IoT key","info":"a-o02bld-overqbyt53\nTH(jl)UJ!moJ!imVct\n\n#open devuce created\na-o062sb-r0sbsqcx94\nOhie@Y9h?+5ONkzydj\n\nhttps://n8ve7d.internetofthings.ibmcloud.com/dashboard/devices/browse\n\na-n8ve7d-9sgh0dvugd\np-voV210olgBt7Lpjh","x":130,"y":720,"wires":[]},{"id":"54158591.2d7c7c","type":"comment","z":"98ac791d.6af398","name":"get your LABid form http://thinklab1239.mybluemix.net/claimids","info":"","x":770,"y":80,"wires":[]},{"id":"ca824647.938588","type":"function","z":"98ac791d.6af398","name":"GetMyPWS","func":"\nreturn msg;","outputs":1,"noerr":0,"x":330,"y":640,"wires":[["2d2f7d9f.7234c2"]]},{"id":"c032796d.7e8c28","type":"function","z":"2867dcd3.cb18c4","name":"Set PWS Markter","func":"\nmsg.payload.layer = \"pwsall\";\nmsg.payload.name  = msg.payload.pws\nmsg.payload.icon  = \"globe\";\nmsg.payload.iconColor = \"orange\";\n\nif(!isNaN(msg.payload.pws))\n{\n    msg.payload.iconColor = \"orange\"//+msg.payload.pws;\n    if(parseInt(msg.payload.pws) < 11)\n        msg.payload.iconColor = \"#55FF\"+msg.payload.pws;\n    if(parseInt(msg.payload.pws) > 10 && parseInt(msg.payload.pws) <21 )\n        msg.payload.iconColor = \"#FF55\"+msg.payload.pws;\n    if(parseInt(msg.payload.pws) > 20 && parseInt(msg.payload.pws) <31 )\n        msg.payload.iconColor = \"#\"+msg.payload.pws+\"22FF\"\n    if(parseInt(msg.payload.pws) > 30 && parseInt(msg.payload.pws) <41 )\n        msg.payload.iconColor = \"#55\"+msg.payload.pws+\"88\"\n}\n\n\n\nif(msg.payload.pws == \"NoLabID\")\n    msg.payload.iconColor = \"black\";\n    \n    \nif(msg.payload.pws == \"iss\")\n{\nmsg.payload.name  = \"Space Station\";\nmsg.payload.icon  = \"fa-space-shuttle\";\nmsg.payload.iconColor = \"blue\";\n}\n\nmsg.payload.command = { zoom:3, \n                            \"lat\":msg.payload.lat,\n                            \"lon\":msg.payload.lon,\n                            autopan:true };\n//delete msg.payload.command \nreturn msg;","outputs":1,"noerr":0,"x":590,"y":200,"wires":[["938fb9ce.21dd48","d9382115.32587"]]},{"id":"938fb9ce.21dd48","type":"ui_worldmap","z":"2867dcd3.cb18c4","group":"c3ca51fe.2d4e6","order":4,"width":"22","height":"18","name":"","lat":"43.6711","lon":"-79.4141","zoom":"3","layer":"Esri","cluster":"6","maxage":"600","usermenu":"hide","layers":"hide","panit":"false","panlock":"false","zoomlock":"false","hiderightclick":"false","coords":"deg","showgrid":"false","path":"/worldallpws","x":830,"y":240,"wires":[]},{"id":"d9382115.32587","type":"debug","z":"2867dcd3.cb18c4","name":"MapIT","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":810,"y":200,"wires":[]},{"id":"40b4aa14.c57a94","type":"ibmiot in","z":"2867dcd3.cb18c4","authentication":"boundService","apiKey":"","inputType":"evt","logicalInterface":"","ruleId":"","deviceId":"","applicationId":"","deviceType":"pws","eventType":"+","commandType":"","format":"json","name":"All PWS","service":"registered","allDevices":true,"allApplications":"","allDeviceTypes":false,"allLogicalInterfaces":"","allEvents":true,"allCommands":"","allFormats":true,"qos":0,"x":210,"y":200,"wires":[["cc5d78ab.d72178","9b5fde99.72e2"]]},{"id":"cc5d78ab.d72178","type":"debug","z":"2867dcd3.cb18c4","name":"IoT incoming","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","x":420,"y":260,"wires":[]},{"id":"9b5fde99.72e2","type":"delay","z":"2867dcd3.cb18c4","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":410,"y":200,"wires":[["c032796d.7e8c28"]]},{"id":"80642e01.fc57c","type":"inject","z":"2867dcd3.cb18c4","name":"Test Message Toronto","topic":"","payload":"{\"temperature\":6,\"observation\":\"Mostly Cloudy\",\"humidity\":43,\"pressure\":1014.7,\"uvindex\":3,\"precip\":0,\"ts\":1586620806125,\"messtime\":\"2020-04-11T11:50:30-0400\",\"day\":\"Saturday\",\"lat\":43.6711,\"lon\":-79.4141,\"source\":\"TWC\",\"pws\":\"00\",\"layer\":\"pwsall\",\"name\":\"test00\",\"icon\":\"globe\",\"iconColor\":\"orange\",\"command\":{\"zoom\":6,\"lat\":43.6711,\"lon\":-79.4141,\"autopan\":true}}","payloadType":"json","repeat":"","crontab":"","once":false,"onceDelay":"3","x":180,"y":140,"wires":[["9b5fde99.72e2"]]},{"id":"3e2f0142.e0ac0e","type":"comment","z":"2867dcd3.cb18c4","name":"use url ....  youinstance mybluemix.net/worldallpws","info":"or \nhttps://.....mybluemix.net/ui/\nor\nhttps://thinklab1239.mybluemix.net/worldallpws","x":250,"y":80,"wires":[]},{"id":"4edf0e91.5dcce","type":"http request","z":"4acf96d8.68a2f8","name":"","method":"GET","ret":"obj","url":"http://open-notify-api.herokuapp.com/iss-now.json","tls":"","x":350,"y":320,"wires":[["712f24b.1d36ddc","5e7789b.c845978"]]},{"id":"712f24b.1d36ddc","type":"debug","z":"4acf96d8.68a2f8","name":"IssiPos","active":true,"console":"false","complete":"payload","x":530.5,"y":321.5,"wires":[]},{"id":"4f92b80d.6f2da8","type":"inject","z":"4acf96d8.68a2f8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":"","x":108.5,"y":319.25,"wires":[["4edf0e91.5dcce"]]},{"id":"5e7789b.c845978","type":"function","z":"4acf96d8.68a2f8","name":"Mapping/Send ISS info","func":"msg.payloadold=msg.payload\nmsg.payload={}\nmsg.payload.temperature=msg.payloadold.temperature\nmsg.payload.observation=msg.payloadold.wxPhraseLong\nmsg.payload.humidity   =msg.payloadold.relativeHumidity\nmsg.payload.pressure   =msg.payloadold.pressureMeanSeaLevel\nmsg.payload.uvindex    =msg.payloadold.uvIndex\nmsg.payload.precip     =msg.payloadold.precip1Hour\nmsg.payload.ts         =Date.now()\nmsg.payload.messtime   =msg.payloadold.validTimeLocal\nmsg.payload.day=msg.payloadold.dayOfWeek\nmsg.payload.lat=(msg.payloadold.iss_position.latitude).toFixed(4)\nmsg.payload.lon=(msg.payloadold.iss_position.longitude).toFixed(4)\nmsg.payload.source=\"TWC\"\nmsg.payload.pws=\"iss\"\nmsg.deviceId=\"pwsiss\"\nreturn msg;\n/*\n{\n    \"cloudCeiling\": 5000,\n    \"cloudCoverPhrase\": \"Mostly Cloudy\",\n    \"dayOfWeek\": \"Friday\",\n    \"dayOrNight\": \"D\",\n    \"expirationTimeUtc\": 1586545455,\n    \"iconCode\": 28,\n    \"iconCodeExtend\": 2890,\n    \"obsQualifierCode\": null,\n    \"obsQualifierSeverity\": null,\n    \"precip1Hour\": 0,\n    \"precip6Hour\": 0,\n    \"precip24Hour\": 0,\n    \"pressureAltimeter\": 1005.08,\n    \"pressureChange\": 2.03,\n    \"pressureMeanSeaLevel\": 1005.2,\n    \"pressureTendencyCode\": 1,\n    \"pressureTendencyTrend\": \"Rising\",\n    \"relativeHumidity\": 42,\n    \"snow1Hour\": 0,\n    \"snow6Hour\": 0,\n    \"snow24Hour\": 0,\n    \"sunriseTimeLocal\": \"2020-04-10T06:43:19-0400\",\n    \"sunriseTimeUtc\": 1586515399,\n    \"sunsetTimeLocal\": \"2020-04-10T19:56:57-0400\",\n    \"sunsetTimeUtc\": 1586563017,\n    \"temperature\": 7,\n    \"temperatureChange24Hour\": -2,\n    \"temperatureDewPoint\": -5,\n    \"temperatureFeelsLike\": 2,\n    \"temperatureHeatIndex\": 7,\n    \"temperatureMax24Hour\": 8,\n    \"temperatureMaxSince7Am\": 7,\n    \"temperatureMin24Hour\": 1,\n    \"temperatureWindChill\": 2,\n    \"uvDescription\": \"Moderate\",\n    \"uvIndex\": 4,\n    \"validTimeLocal\": \"2020-04-10T14:54:15-0400\",\n    \"validTimeUtc\": 1586544855,\n    \"visibility\": 16.09,\n    \"windDirection\": 300,\n    \"windDirectionCardinal\": \"WNW\",\n    \"windGust\": 56,\n    \"windSpeed\": 37,\n    \"wxPhraseLong\": \"Mostly Cloudy/Wind\",\n    \"wxPhraseMedium\": \"Mostly Cloudy/Wind\",\n    \"wxPhraseShort\": \"M Cldy/Wind\"\n}\n*/","outputs":1,"noerr":0,"x":590,"y":260,"wires":[["f514977e.cdd108"]]},{"id":"f514977e.cdd108","type":"ibmiot out","z":"4acf96d8.68a2f8","authentication":"boundService","apiKey":"6cdfc924.a49268","outputType":"evt","deviceId":"pwsiss","deviceType":"pws","eventCommandType":"weather","format":"json","data":"msg","qos":0,"name":"toIoT","service":"registered","x":810,"y":260,"wires":[]},{"id":"2a513af0.ebfd46","type":"comment","z":"4acf96d8.68a2f8","name":"Get ISS position and mapp it","info":"","x":160,"y":260,"wires":[]}]
